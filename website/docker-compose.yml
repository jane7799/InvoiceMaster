version: "3.9"

services:
  # 静态文件服务
  web:
    image: halverneus/static-file-server:latest
    container_name: invoice-web
    environment:
      - FOLDER=/web
    volumes:
      - /vol1/1000/tools/invoice-web/html:/web
    restart: unless-stopped

  # 下载统计服务
  stats:
    build: /vol1/1000/tools/invoice-web/stats-service
    container_name: invoice-stats
    volumes:
      - /vol1/1000/tools/invoice-web/data:/data
    restart: unless-stopped

  # Nginx反向代理
  nginx:
    image: nginx:alpine
    container_name: invoice-nginx
    ports:
      - "8890:80"
    volumes:
      - /vol1/1000/tools/invoice-web/nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - web
      - stats
    restart: unless-stopped
