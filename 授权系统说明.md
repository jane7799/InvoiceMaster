# 授权系统功能说明

## ✅ 已实现功能

### 1. 机器码生成
- 自动生成唯一机器码（基于硬件信息）
- 支持 Windows、macOS、Linux/UOS
- 机器码格式：XXXX-XXXX-XXXX-XXXX

### 2. 激活码验证
- 使用 HMAC-SHA256 加密算法
- 每个机器码对应唯一激活码
- 激活状态永久保存

### 3. 试用机制
- 未激活用户可免费试用 10 次 Excel 导出
- 每次导出后显示剩余次数
- 试用用完后必须激活

### 4. 用户界面
- 设置中显示激活状态
- 激活管理对话框
- 机器码复制功能
- 激活码输入验证

---

## 📁 相关文件

### 核心文件
1. `license_manager.py` - 授权管理模块
2. `generate_activation_code.py` - 激活码生成工具（仅供开发者使用）
3. `InvoiceMaster.py` - 主程序（已集成授权功能）

### 文档文件
1. `激活码使用说明.md` - 激活码生成工具使用指南
2. `授权系统说明.md` - 本文档

---

## 🎯 用户使用流程

1. **首次使用**
   - 运行软件
   - 尝试导出 Excel
   - 提示："剩余 10 次试用机会"

2. **试用期间**
   - 每次导出显示剩余次数
   - 例如："剩余 7 次免费导出机会"

3. **试用用完**
   - 弹出激活窗口
   - 显示机器码
   - 用户将机器码发送给开发者

4. **激活**
   - 收到激活码
   - 在激活窗口输入
   - 点击"立即激活"
   - 激活成功！

---

## 🔑 开发者操作

### 生成激活码

```bash
# 进入项目目录
cd /Users/jane/Desktop/Invoice-Project

# 运行激活码生成工具
python3 generate_activation_code.py

# 或直接指定机器码
python3 generate_activation_code.py A3F2-8B4C-D1E9-7A5B
```

### 示例输出

```
============================================================
智能发票管理助手 - 激活码生成工具
============================================================

✅ 激活码生成成功！
------------------------------------------------------------
机器码：A3F2-8B4C-D1E9-7A5B
激活码：B7E4-9A2C-F1D8-3E6A
------------------------------------------------------------

请将激活码发送给用户。
```

---

## ⚠️ 安全注意事项

1. **保密 `generate_activation_code.py` 脚本**
   - 不要分发给用户
   - 妥善保管

2. **密钥管理**
   - 当前密钥：`InvoiceMaster2024SecretKey#@!`
   - 如需修改，必须同时修改两个文件：
     - `license_manager.py`
     - `generate_activation_code.py`

3. **激活状态存储位置**
   - Windows: 注册表 `HKEY_CURRENT_USER\Software\MySoft\InvoiceMaster`
   - macOS: `~/Library/Preferences/com.MySoft.InvoiceMaster.plist`
   - Linux: `~/.config/MySoft/InvoiceMaster.conf`

---

## 🧪 测试建议

### 基础测试
- [x] 机器码生成
- [x] 激活码生成工具
- [ ] 完整激活流程
- [ ] 试用次数计数

### 跨平台测试
- [ ] Windows 10/11
- [ ] macOS
- [ ] Linux/UOS

---

## 📞 技术支持

如有问题，请查看：
- `激活码使用说明.md` - 详细使用教程
- 源代码注释
